<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>无星的小窝</title>
    <link>http://blog.xingxiaowu.cn/</link>
    
    <atom:link href="http://blog.xingxiaowu.cn/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>一个么的前途的弟中弟</description>
    <pubDate>Thu, 21 Nov 2024 08:47:15 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title></title>
      <link>http://blog.xingxiaowu.cn/2024/11/21/CTF/%E5%A4%A9%E5%B7%A5%E6%9D%AF/</link>
      <guid>http://blog.xingxiaowu.cn/2024/11/21/CTF/%E5%A4%A9%E5%B7%A5%E6%9D%AF/</guid>
      <pubDate>Thu, 21 Nov 2024 08:11:28 GMT</pubDate>
      
        
        
      <description>&lt;ol&gt;
&lt;li&gt;&lt;p&gt;查看进程&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line</description>
        
      
      
      
      <content:encoded><![CDATA[<ol><li><p>查看进程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps aux</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>nginx</p></li></ol>]]></content:encoded>
      
      
      
      
      <comments>http://blog.xingxiaowu.cn/2024/11/21/CTF/%E5%A4%A9%E5%B7%A5%E6%9D%AF/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>无星的渗透之旅速成篇（十）-给Burp设置上层代理</title>
      <link>http://blog.xingxiaowu.cn/2024/11/17/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E5%8D%81%EF%BC%89-%E7%BB%99Burp%E8%AE%BE%E7%BD%AE%E4%B8%8A%E5%B1%82%E4%BB%A3%E7%90%86/</link>
      <guid>http://blog.xingxiaowu.cn/2024/11/17/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E5%8D%81%EF%BC%89-%E7%BB%99Burp%E8%AE%BE%E7%BD%AE%E4%B8%8A%E5%B1%82%E4%BB%A3%E7%90%86/</guid>
      <pubDate>Sun, 17 Nov 2024 12:09:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;给浏览器设置走Burp&quot;&gt;&lt;a href=&quot;#给浏览器设置走Burp&quot; class=&quot;headerlink&quot; title=&quot;给浏览器设置走Burp&quot;&gt;&lt;/a&gt;给浏览器设置走Burp&lt;/h1&gt;&lt;p&gt;装这玩意&lt;a href=&quot;https://microsoftedge</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="给浏览器设置走Burp"><a href="#给浏览器设置走Burp" class="headerlink" title="给浏览器设置走Burp"></a>给浏览器设置走Burp</h1><p>装这玩意<a href="https://microsoftedge.microsoft.com/addons/detail/proxy-switchyomega/fdbloeknjpnloaggplaobopplkdhnikc?hl=zh-CN">Proxy SwitchyOmega</a></p><p>新建一个情景模式</p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F10/20241117201410.png" alt="新建情景模式"></p><p>然后应用选项</p><p>并且选择它</p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F10/20241117201448.png"></p><p>好了,现在浏览器就走Burp了</p><h1 id="给Burp设置上游代理"><a href="#给Burp设置上游代理" class="headerlink" title="给Burp设置上游代理"></a>给Burp设置上游代理</h1><p>如果不设置,那么流量是这么走的</p><p><code>浏览器 -&gt; Burp -&gt; 目标网站</code></p><p>这样其实会暴露本机ip地址</p><p>所以我们需要设置Burp的上游代理</p><p>设置以后就会是</p><p><code>浏览器 -&gt; Burp -&gt; 上游代理服务器 -&gt; 目标网站</code></p><h2 id="1-开启Lan"><a href="#1-开启Lan" class="headerlink" title="1. 开启Lan"></a>1. 开启Lan</h2><p>我这里以<code>clash</code>为例</p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F10/20241117201735.png"></p><p><code>clash</code>的代理服务在<code>http://127.0.0.1:7890</code></p><h2 id="2-设置Burp"><a href="#2-设置Burp" class="headerlink" title="2. 设置Burp"></a>2. 设置Burp</h2><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F10/20241117201647.png"></p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F10/20241117201940.png"></p><p>就好了</p><p>可以自行测试打勾前后,查询自己ip的情况</p>]]></content:encoded>
      
      
      <category domain="http://blog.xingxiaowu.cn/categories/%E5%AE%89%E5%85%A8/">安全</category>
      
      
      <category domain="http://blog.xingxiaowu.cn/tags/%E6%B8%97%E9%80%8F/">渗透</category>
      
      
      <comments>http://blog.xingxiaowu.cn/2024/11/17/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E5%8D%81%EF%BC%89-%E7%BB%99Burp%E8%AE%BE%E7%BD%AE%E4%B8%8A%E5%B1%82%E4%BB%A3%E7%90%86/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>无星的渗透之旅速成篇（九）-工具汇总</title>
      <link>http://blog.xingxiaowu.cn/2024/10/30/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E4%B9%9D%EF%BC%89-%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/</link>
      <guid>http://blog.xingxiaowu.cn/2024/10/30/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E4%B9%9D%EF%BC%89-%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/</guid>
      <pubDate>Wed, 30 Oct 2024 12:09:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;阿星每次找工具都找的累死了&lt;/p&gt;
&lt;p&gt;决定存档&lt;/p&gt;
&lt;h1 id=&quot;空间测绘&quot;&gt;&lt;a href=&quot;#空间测绘&quot; class=&quot;headerlink&quot; title=&quot;空间测绘&quot;&gt;&lt;/a&gt;空间测绘&lt;/h1&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<p>阿星每次找工具都找的累死了</p><p>决定存档</p><h1 id="空间测绘"><a href="#空间测绘" class="headerlink" title="空间测绘"></a>空间测绘</h1>]]></content:encoded>
      
      
      <category domain="http://blog.xingxiaowu.cn/categories/%E5%AE%89%E5%85%A8/">安全</category>
      
      
      <category domain="http://blog.xingxiaowu.cn/tags/%E6%B8%97%E9%80%8F/">渗透</category>
      
      
      <comments>http://blog.xingxiaowu.cn/2024/10/30/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E4%B9%9D%EF%BC%89-%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>无星的渗透之旅速成篇（八）-邮件钓鱼</title>
      <link>http://blog.xingxiaowu.cn/2024/10/30/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E5%85%AB%EF%BC%89-%E9%82%AE%E4%BB%B6%E9%92%93%E9%B1%BC/</link>
      <guid>http://blog.xingxiaowu.cn/2024/10/30/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E5%85%AB%EF%BC%89-%E9%82%AE%E4%BB%B6%E9%92%93%E9%B1%BC/</guid>
      <pubDate>Wed, 30 Oct 2024 12:09:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;几天了,毫无进展&lt;/p&gt;
&lt;p&gt;钓鱼试一下把&lt;/p&gt;
&lt;p&gt;邮件钓鱼好像很有意思&lt;/p&gt;
&lt;h1 id=&quot;SPF&quot;&gt;&lt;a href=&quot;#SP</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>几天了,毫无进展</p><p>钓鱼试一下把</p><p>邮件钓鱼好像很有意思</p><h1 id="SPF"><a href="#SPF" class="headerlink" title="SPF"></a>SPF</h1><p>首先我们需要了解<code>SPF</code></p><p><code>SPF</code>的全称是Sender Policy Framework，即发件人策略框架</p><p>说简单一点,SMTP框架设置的很简略,允许任何人声明他是谁并给你发邮件,但是其实并不能保证他真的是谁</p><p>那么就要打补丁了</p><p>补丁就是<code>SPF</code></p><p><code>SPF</code>其实就是一条DNS记录</p><p>比如腾讯的SPF声明它的邮件服务器ip段是a.a.a.1-a.a.a.254</p><p>比如你通过自己的邮箱服务器,声明自己是<code>腾讯</code>,并发送邮件,你的ip是b.b.b.1</p><p>那么收件方的收件服务器就会去解析你的<code>SPF</code>记录,是否是<code>腾讯</code>的服务器发送的邮件</p><p>如果不是,那么很明显,你是伪造的了</p><h2 id="SPF校验"><a href="#SPF校验" class="headerlink" title="SPF校验"></a>SPF校验</h2><p>那如果腾讯没有声明他的<code>SPF</code>呢?</p><p>是的盲生,你发现了华点,如果对方没有声明,那么收件服务器就会认为他SPF校验通过了</p><p>上面说了,大部分的大公司,都会声明自己的SPF</p><p>但是很多小公司就不一定了</p><p>我们可以通过下面两个命令,看是否有声明</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># windows</span></span><br><span class="line">win:  nslookup -<span class="built_in">type</span>=txt qq.com</span><br><span class="line">      nslookup -q=txt qq.com</span><br><span class="line"></span><br><span class="line">linux:  dig qq.com txt</span><br><span class="line"></span><br><span class="line">mac: dig qq.com txt</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F8/20241030143306.png"></p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F8/20241030143640.png"></p><h1 id="Swaks"><a href="#Swaks" class="headerlink" title="Swaks"></a>Swaks</h1><p>kali内置</p><p>让我们来试试</p><p>参数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--from  <span class="built_in">test</span>@qq.com     //发件人邮箱；</span><br><span class="line">--ehlo   qq.com      //伪造邮件ehlo头，即是发件人邮箱的域名。提供身份认证</span><br><span class="line">--body  <span class="string">&quot;http://www.baidu.com&quot;</span>    //引号中的内容即为邮件正文；</span><br><span class="line">--header  <span class="string">&quot;Subject:hello&quot;</span>   //邮件头信息，subject为邮件标题</span><br><span class="line">--data   ./Desktop/email.txt    //将正常源邮件的内容保存成TXT文件，再作为正常邮件发送；</span><br></pre></td></tr></table></figure><p>基本语法</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swaks --body &quot;内容&quot; --header &quot;Subject:标题&quot; -t xxxxx@qq.com -f &quot;admin@qq.com&quot;  --server 你的邮件服务器地址 -p 25 -au &lt;USER&gt; -ap &lt;PASS&gt;</span><br></pre></td></tr></table></figure><h2 id="SPF绕过"><a href="#SPF绕过" class="headerlink" title="SPF绕过"></a>SPF绕过</h2><p>由于邮件显示的是Header中的From不是smtp.from，因此可以将smtp.from设置为正常的邮件服务器地址，伪造一个Mail.From(发件人)即可。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swaks --to xxx@gmail.com --from @kevin.com(你的邮件地址) --h-From: &#x27;管理员&lt;admin@qq.com&gt;&#x27; --ehlo gmail.com --body hello --server 邮件服务器地址 -p 25 -au 账号 -ap 密码</span><br></pre></td></tr></table></figure><p>如果我想去除Mailer特征，就可以这么做：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swaks --header-X-Mailer gmail.com --to xxx@gmail.com --from xxx@kevin.com(你的邮件地址) --h-From: &#x27;管理员&lt;admin@qq.com&gt;&#x27; --ehlo gmail.com --body hello --server 邮件服务器地址 -p 25 -au 账号 -ap 密码</span><br></pre></td></tr></table></figure><h1 id="gophish"><a href="#gophish" class="headerlink" title="gophish"></a>gophish</h1><p><a href="https://github.com/gophish/gophish">https://github.com/gophish/gophish</a></p>]]></content:encoded>
      
      
      <category domain="http://blog.xingxiaowu.cn/categories/%E5%AE%89%E5%85%A8/">安全</category>
      
      
      <category domain="http://blog.xingxiaowu.cn/tags/%E6%B8%97%E9%80%8F/">渗透</category>
      
      
      <comments>http://blog.xingxiaowu.cn/2024/10/30/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E5%85%AB%EF%BC%89-%E9%82%AE%E4%BB%B6%E9%92%93%E9%B1%BC/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>无星的渗透之旅速成篇（七）-Proxifier使用</title>
      <link>http://blog.xingxiaowu.cn/2024/10/22/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E4%B8%83%EF%BC%89-Proxifier%E4%BD%BF%E7%94%A8/</link>
      <guid>http://blog.xingxiaowu.cn/2024/10/22/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E4%B8%83%EF%BC%89-Proxifier%E4%BD%BF%E7%94%A8/</guid>
      <pubDate>Tue, 22 Oct 2024 12:09:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;有同事不会配,帮忙配了一下,顺带记录成文字&lt;/p&gt;
&lt;h1 id=&quot;页面介绍&quot;&gt;&lt;a href=&quot;#页面介绍&quot; class=&quot;headerl</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>有同事不会配,帮忙配了一下,顺带记录成文字</p><h1 id="页面介绍"><a href="#页面介绍" class="headerlink" title="页面介绍"></a>页面介绍</h1><p>装完长这个样子</p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F7/20241022161949.png"></p><h1 id="1-配置可用的代理服务"><a href="#1-配置可用的代理服务" class="headerlink" title="1.配置可用的代理服务"></a>1.配置可用的代理服务</h1><p>我们有时候会起不同的代理服务以应对不同的需求</p><p>比如有时候翻墙我们会使用小猫咪或者小飞机</p><p>而进行安全测试的时候则使用Burp</p><p>开发有时候轻量一点会使用Fiddler或者Charles</p><p>所以我们需要配置我们的代理服务</p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F7/20241022162209.png"></p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F7/20241022162253.png"></p><p>当然看起来非常简单,就是填个ip和端口,选个协议就行了</p><p>一般我们选择<code>https</code></p><h1 id="2-配置代理规则"><a href="#2-配置代理规则" class="headerlink" title="2.配置代理规则"></a>2.配置代理规则</h1><p>那么有了代理服务之后,我们还需要配置代理规则</p><p>说人话就是:哪些流量走哪些代理,或者不走代理直连</p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F7/20241022162508.png"></p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F7/20241022162556.png"></p><p>我们一项项解释</p><p>其实写的很明白了,规则是从顶部到底部处理,也就是说如果你配置了重复的规则,那么会以最后一条为准(不过一般也没人这么做吧)</p><p>看这五列:规则名称&#x2F;应用程序&#x2F;目标主机&#x2F;目标端口&#x2F;动作</p><h2 id="规则名称"><a href="#规则名称" class="headerlink" title="规则名称"></a>规则名称</h2><p>自己想叫什么就叫什么</p><h2 id="应用程序"><a href="#应用程序" class="headerlink" title="应用程序"></a>应用程序</h2><p>哪些应用程序需要走代理<br><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F7/20241022163054.png"></p><p>这个看自己的需求了</p><p>比如我需要微信走代理</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wechatappex.exe</span><br></pre></td></tr></table></figure><p>steam走代理</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steam.exe</span><br></pre></td></tr></table></figure><p>饥荒走代理</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dontstarve_steam.exe;dontstarve_dedicated_server_nullrenderer.exe;</span><br></pre></td></tr></table></figure><p>有兄弟会好奇,这些应用名称都哪来的?</p><p>这个其实有各种方法可以获得,比如你直接看任务管理器</p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F7/20241022163458.png"></p><p><img src="https://cdn.jsdelivr.net/gh/XingXiaoWu/XingXiaoWu.github.io@pic/%E6%B8%97%E9%80%8F7/20241022163530.png"></p><p>有些兄弟会问,这么多,写哪个呢?大不了就全写上呗,也不费什么事,右键选择<code>在文件位置中打开</code>直接复制粘贴名称就完事了.</p><p>也可以百度直接抄前人的经验</p><h2 id="目标主机和目标端口"><a href="#目标主机和目标端口" class="headerlink" title="目标主机和目标端口"></a>目标主机和目标端口</h2><p>就和他的名字一样,你通过这个规则需要访问的目标的主机域名,ip和端口</p><p>一般我都是任意,因为我在翻墙这种需求中,有小猫咪帮我配好pac规则,我不使用<code>Proxifier</code>,当然,它一样能做到这个事.</p><h2 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h2><p>最后就是Acton了,选择你的代理服务器,或者直连,或者拦截</p><p>此外请注意,这些条件之间的规则是<code>且规则</code>,应该不用再解释</p><p>如果你需要<code>指定域名</code>走指定代理,那么只要填域名就行了</p><h1 id="Over"><a href="#Over" class="headerlink" title="Over"></a>Over</h1>]]></content:encoded>
      
      
      <category domain="http://blog.xingxiaowu.cn/categories/%E5%AE%89%E5%85%A8/">安全</category>
      
      
      <category domain="http://blog.xingxiaowu.cn/tags/%E6%B8%97%E9%80%8F/">渗透</category>
      
      
      <comments>http://blog.xingxiaowu.cn/2024/10/22/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E4%B8%83%EF%BC%89-Proxifier%E4%BD%BF%E7%94%A8/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>无星的渗透之旅速成篇（六）-ip轮转</title>
      <link>http://blog.xingxiaowu.cn/2024/10/22/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E5%85%AD%EF%BC%89-ip%E8%BD%AE%E8%BD%AC/</link>
      <guid>http://blog.xingxiaowu.cn/2024/10/22/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E5%85%AD%EF%BC%89-ip%E8%BD%AE%E8%BD%AC/</guid>
      <pubDate>Tue, 22 Oct 2024 12:09:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;a href=&quot;https://developer.volcengine.com/articles/7381520178355372042&quot;&gt;https://developer.volcengine.com/articles/7381520178355372042&lt;/a&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<p><a href="https://developer.volcengine.com/articles/7381520178355372042">https://developer.volcengine.com/articles/7381520178355372042</a></p><p>  <code>Access Key:AKIAISGP63MXTUVKLTHA</code><br>  <code>Secret Key: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</code></p>]]></content:encoded>
      
      
      <category domain="http://blog.xingxiaowu.cn/categories/%E5%AE%89%E5%85%A8/">安全</category>
      
      
      <category domain="http://blog.xingxiaowu.cn/tags/%E6%B8%97%E9%80%8F/">渗透</category>
      
      
      <comments>http://blog.xingxiaowu.cn/2024/10/22/CTF/%E6%97%A0%E6%98%9F%E7%9A%84%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85%E9%80%9F%E6%88%90%E7%AF%87%EF%BC%88%E5%85%AD%EF%BC%89-ip%E8%BD%AE%E8%BD%AC/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>无星的docker学习（一）- 环境准备</title>
      <link>http://blog.xingxiaowu.cn/2024/10/13/%E8%BF%90%E7%BB%B4%E6%9D%82%E8%B0%88/%E6%97%A0%E6%98%9F%E7%9A%84docker%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89-%20%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/</link>
      <guid>http://blog.xingxiaowu.cn/2024/10/13/%E8%BF%90%E7%BB%B4%E6%9D%82%E8%B0%88/%E6%97%A0%E6%98%9F%E7%9A%84docker%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89-%20%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/</guid>
      <pubDate>Sun, 13 Oct 2024 01:38:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Centos&quot;&gt;&lt;a href=&quot;#Centos&quot; class=&quot;headerlink&quot; title=&quot;Centos&quot;&gt;&lt;/a&gt;Centos&lt;/h1&gt;&lt;h2 id=&quot;安装docker&quot;&gt;&lt;a href=&quot;#安装docker&quot; class=&quot;headerlink&quot; </description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Centos"><a href="#Centos" class="headerlink" title="Centos"></a>Centos</h1><h2 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum check-update</span><br><span class="line">sudo yum install -y yum-utils</span><br><span class="line">yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="comment">#sudo yum install docker -y</span></span><br><span class="line">sudo yum install -y docker-ce</span><br><span class="line">sudo systemctl start docker</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> docker</span><br><span class="line">docker --version</span><br></pre></td></tr></table></figure><h2 id="设置镜像"><a href="#设置镜像" class="headerlink" title="设置镜像"></a>设置镜像</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不存在就创建</span></span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line"><span class="comment"># 设置内容</span></span><br><span class="line">&#123;<span class="string">&quot;registry-mirrors&quot;</span>: [</span><br><span class="line"><span class="string">&quot;https://docker.1panel.dev&quot;</span>,</span><br><span class="line"><span class="string">&quot;https://docker.fxxk.dedyn.io&quot;</span>,</span><br><span class="line"><span class="string">&quot;https://docker.xn--6oq72ry9d5zx.cn&quot;</span>,</span><br><span class="line"><span class="string">&quot;https://docker.m.daocloud.io&quot;</span>,</span><br><span class="line"><span class="string">&quot;https://a.ussh.net&quot;</span>,</span><br><span class="line"><span class="string">&quot;https://docker.zhai.cm&quot;</span>]&#125;</span><br><span class="line"><span class="comment">#重载systemd管理守护进程配置文件</span></span><br><span class="line">sudo systemctl daemon-reload </span><br><span class="line"><span class="comment">#重启 Docker 服务</span></span><br><span class="line">sudo systemctl restart docker </span><br></pre></td></tr></table></figure><h3 id="一些镜像地址"><a href="#一些镜像地址" class="headerlink" title="一些镜像地址:"></a>一些镜像地址:</h3><p><a href="https://dockerproxy.cn/">https://dockerproxy.cn/</a></p><h1 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dstserver 是容器名字</span></span><br><span class="line">docker logs -f dstserver</span><br></pre></td></tr></table></figure><h1 id="我常用的一些docker"><a href="#我常用的一些docker" class="headerlink" title="我常用的一些docker"></a>我常用的一些docker</h1><h2 id="ddddocr"><a href="#ddddocr" class="headerlink" title="ddddocr"></a>ddddocr</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull 329106954/ocr_server:centos</span><br><span class="line">docker run -d -p 9898:9898 --name ddddocr imageid</span><br></pre></td></tr></table></figure><h2 id="clash"><a href="#clash" class="headerlink" title="clash"></a>clash</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name=clash -v <span class="string">&quot;<span class="variable">$PWD</span>/clash:/root/.config/clash/&quot;</span> -p <span class="string">&quot;7890:7890&quot;</span> -p <span class="string">&quot;7891:7891&quot;</span> -p <span class="string">&quot;9090:9090&quot;</span> --restart=unless-stopped dreamacro/clash</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="http://blog.xingxiaowu.cn/categories/docker/">docker</category>
      
      
      <category domain="http://blog.xingxiaowu.cn/tags/docker/">docker</category>
      
      
      <comments>http://blog.xingxiaowu.cn/2024/10/13/%E8%BF%90%E7%BB%B4%E6%9D%82%E8%B0%88/%E6%97%A0%E6%98%9F%E7%9A%84docker%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89-%20%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Linux开启Clash</title>
      <link>http://blog.xingxiaowu.cn/2024/10/07/%E8%BF%90%E7%BB%B4%E6%9D%82%E8%B0%88/Linux%E5%BC%80%E5%90%AFClash/</link>
      <guid>http://blog.xingxiaowu.cn/2024/10/07/%E8%BF%90%E7%BB%B4%E6%9D%82%E8%B0%88/Linux%E5%BC%80%E5%90%AFClash/</guid>
      <pubDate>Mon, 07 Oct 2024 07:48:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;方式一-docker安装&quot;&gt;&lt;a href=&quot;#方式一-docker安装&quot; class=&quot;headerlink&quot; title=&quot;方式一 docker安装&quot;&gt;&lt;/a&gt;方式一 docker安装&lt;/h1&gt;&lt;figure class=&quot;highlight plaintex</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="方式一-docker安装"><a href="#方式一-docker安装" class="headerlink" title="方式一 docker安装"></a>方式一 docker安装</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 设置docker加速</span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line"># 填写内容</span><br><span class="line">&#123;&quot;registry-mirrors&quot;: [&quot;https://dockerproxy.cn&quot;]&#125;</span><br><span class="line"># 重启docker</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br><span class="line"></span><br><span class="line"># 安装clash镜像</span><br><span class="line">docker run -d --name=clash -v &quot;$PWD/clash:/root/.config/clash/&quot; -p &quot;7890:7890&quot; -p &quot;7891:7891&quot; -p &quot;9090:9090&quot; --restart=unless-stopped dreamacro/clash</span><br></pre></td></tr></table></figure><p>镜像安装完成,就会在当前目录下生成clash文件夹，打开文件夹，将文件夹下的config.yaml 替换成上面我们从机场购买的配置,就好了</p>]]></content:encoded>
      
      
      <category domain="http://blog.xingxiaowu.cn/categories/clash/">clash</category>
      
      
      <category domain="http://blog.xingxiaowu.cn/tags/clash/">clash</category>
      
      
      <comments>http://blog.xingxiaowu.cn/2024/10/07/%E8%BF%90%E7%BB%B4%E6%9D%82%E8%B0%88/Linux%E5%BC%80%E5%90%AFClash/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>无星的前端之旅（三十一）——Chrome插件监听网络请求</title>
      <link>http://blog.xingxiaowu.cn/2024/09/30/%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85/%E6%97%A0%E6%98%9F%E7%9A%84%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94Chrome%E6%8F%92%E4%BB%B6%E7%9B%91%E5%90%AC%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/</link>
      <guid>http://blog.xingxiaowu.cn/2024/09/30/%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85/%E6%97%A0%E6%98%9F%E7%9A%84%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94Chrome%E6%8F%92%E4%BB%B6%E7%9B%91%E5%90%AC%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/</guid>
      <pubDate>Mon, 30 Sep 2024 10:23:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;需要监听某个网络请求&lt;/p&gt;
&lt;p&gt;并根据body信息做出判断&lt;/p&gt;
&lt;p&gt;将结果展示到插件页面&lt;/p&gt;
&lt;h1 id=&quot;manifest</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>需要监听某个网络请求</p><p>并根据body信息做出判断</p><p>将结果展示到插件页面</p><h1 id="manifest-json"><a href="#manifest-json" class="headerlink" title="manifest.json"></a>manifest.json</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;manifest_version&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;permissions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;contextMenus&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;cookies&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;storage&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;history&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;webRequest&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;webRequestBlocking&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*://*/*&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;http://www.baidu.com/*&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;tabs&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;content_scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;matches&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;http://www.baidu.com/*&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;js&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;content.js&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;run_at&quot;</span><span class="punctuation">:</span> <span class="string">&quot;document_start&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;all_frames&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;browser_action&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;default_title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;default_popup&quot;</span><span class="punctuation">:</span> <span class="string">&quot;popup.html&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;icons&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;16&quot;</span><span class="punctuation">:</span> <span class="string">&quot;icons/icon.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;32&quot;</span><span class="punctuation">:</span> <span class="string">&quot;icons/icon.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;48&quot;</span><span class="punctuation">:</span> <span class="string">&quot;icons/icon.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;128&quot;</span><span class="punctuation">:</span> <span class="string">&quot;icons/icon.png&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;web_accessible_resources&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;injected.js&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="injected-js"><a href="#injected-js" class="headerlink" title="injected.js"></a>injected.js</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> origFetch = <span class="variable language_">window</span>.<span class="property">fetch</span>;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">fetch</span> = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">origFetch</span>(...args);</span><br><span class="line">        <span class="comment">// console.log(&#x27;fetch request:&#x27;, args);</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> [url] = args</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> data = <span class="keyword">await</span> response</span><br><span class="line">            .<span class="title function_">clone</span>()</span><br><span class="line">            .<span class="title function_">json</span>() <span class="comment">// 此处需要根据不同数据调用不同方法</span></span><br><span class="line">            .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 对于二进制大文件可以创建为URL(blob:开头)，供其它脚本访问</span></span><br><span class="line">        <span class="comment">//sessionStorage[&#x27;wave&#x27;] = URL.createObjectURL(data); // 插件需要添加&#x27;storage&#x27;权限</span></span><br><span class="line">        <span class="comment">// // 只监听某些地址</span></span><br><span class="line">        <span class="keyword">if</span> (url === <span class="string">&#x27;./xx/xx/xx&#x27;</span> &amp;&amp; data.<span class="property">respData</span>.<span class="property">corpOther</span>.<span class="title function_">includes</span>(<span class="string">&#x27;xxxx&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">postMessage</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;type&#x27;</span>, <span class="attr">data</span>: data.<span class="property">respData</span> &#125;, <span class="string">&#x27;*&#x27;</span>); <span class="comment">// send to content script</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="comment">// 下面为xhr，需要则打开</span></span><br><span class="line">(<span class="keyword">function</span> (<span class="params">xhr</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> <span class="variable constant_">XHR</span> = <span class="title class_">XMLHttpRequest</span>.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> open = <span class="variable constant_">XHR</span>.<span class="property">open</span>;</span><br><span class="line">    <span class="keyword">var</span> send = <span class="variable constant_">XHR</span>.<span class="property">send</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable constant_">XHR</span>.<span class="property">open</span> = <span class="keyword">function</span> (<span class="params">method, url</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_method</span> = method;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_url</span> = url;</span><br><span class="line">        <span class="keyword">return</span> open.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="variable constant_">XHR</span>.<span class="property">send</span> = <span class="keyword">function</span> (<span class="params">postData</span>) &#123;</span><br><span class="line">        <span class="comment">// console.log(&#x27;xhr request:&#x27;, this._method, this._url, postData);</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// sessionStorage[&#x27;key&#x27;] = JSON.stringify(response); // 插件需要添加&#x27;storage&#x27;权限</span></span><br><span class="line">            <span class="comment">// document.cookie</span></span><br><span class="line">            <span class="comment">// localStorage[&#x27;key&#x27;]</span></span><br><span class="line">            <span class="comment">// console.log(&#x27;xhr监听完成&#x27;);</span></span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">postMessage</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;xhr&#x27;</span>, <span class="attr">data</span>: <span class="variable language_">this</span>.<span class="property">response</span> &#125;, <span class="string">&#x27;*&#x27;</span>);  <span class="comment">// 将响应发送到 content script</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> send.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)(<span class="title class_">XMLHttpRequest</span>);</span><br></pre></td></tr></table></figure><h1 id="content-js"><a href="#content-js" class="headerlink" title="content.js"></a>content.js</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;编号查询插件注入成功&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// inject injected script</span></span><br><span class="line"><span class="keyword">let</span> s = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">s.<span class="property">src</span> = chrome.<span class="property">runtime</span>.<span class="title function_">getURL</span>(<span class="string">&#x27;injected.js&#x27;</span>);</span><br><span class="line">s.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">remove</span>();</span><br><span class="line">&#125;;</span><br><span class="line">(<span class="variable language_">document</span>.<span class="property">head</span> || <span class="variable language_">document</span>.<span class="property">documentElement</span>).<span class="title function_">appendChild</span>(s);</span><br><span class="line"></span><br><span class="line"><span class="comment">// receive message from injected script</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="comment">// 判断类型</span></span><br><span class="line">  <span class="keyword">const</span> type = e.<span class="property">data</span>.<span class="property">type</span></span><br><span class="line">  <span class="keyword">if</span> (type === <span class="string">&#x27;ocr&#x27;</span>) &#123;</span><br><span class="line">    chrome.<span class="property">storage</span>.<span class="property">local</span>.<span class="title function_">get</span>([<span class="string">&quot;result&quot;</span>], <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">123</span>);</span><br><span class="line">      <span class="keyword">const</span> data = result.<span class="property">result</span> ?? <span class="string">&#x27;&#x27;</span></span><br><span class="line">      <span class="keyword">const</span> tmp = data + e.<span class="property">data</span>.<span class="property">data</span> + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">      chrome.<span class="property">storage</span>.<span class="property">local</span>.<span class="title function_">set</span>(&#123; <span class="attr">result</span>: tmp &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="popup-html"><a href="#popup-html" class="headerlink" title="popup.html"></a>popup.html</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.main</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.main</span> <span class="selector-class">.textarea</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>以下为请求结果<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;clearButton&quot;</span>&gt;</span>清空结果<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;getResultButton&quot;</span>&gt;</span>获取结果<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;result&quot;</span> <span class="attr">class</span>=<span class="string">&quot;textarea&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./popup.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="popup-js"><a href="#popup-js" class="headerlink" title="popup.js"></a>popup.js</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clear</span>(<span class="params"></span>) &#123;</span><br><span class="line">    chrome.<span class="property">storage</span>.<span class="property">local</span>.<span class="title function_">set</span>(&#123; <span class="string">&quot;result&quot;</span>: <span class="string">&quot;&quot;</span> &#125;, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;result&#x27;</span>).<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getResult</span>(<span class="params"></span>) &#123;</span><br><span class="line">    chrome.<span class="property">storage</span>.<span class="property">local</span>.<span class="title function_">get</span>([<span class="string">&quot;result&quot;</span>], <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> data = result.<span class="property">result</span> ?? <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;result&#x27;</span>).<span class="property">value</span> = data;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> button = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;clearButton&#x27;</span>)</span><br><span class="line">button.<span class="property">onclick</span> = clear</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> button2 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;getResultButton&#x27;</span>)</span><br><span class="line">button2.<span class="property">onclick</span> = getResult</span><br><span class="line"></span><br><span class="line"><span class="title function_">getResult</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="http://blog.xingxiaowu.cn/categories/%E5%89%8D%E7%AB%AF/">前端</category>
      
      
      <category domain="http://blog.xingxiaowu.cn/tags/%E5%89%8D%E7%AB%AF/">前端</category>
      
      <category domain="http://blog.xingxiaowu.cn/tags/chrome%E6%8F%92%E4%BB%B6/">chrome插件</category>
      
      
      <comments>http://blog.xingxiaowu.cn/2024/09/30/%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85/%E6%97%A0%E6%98%9F%E7%9A%84%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94Chrome%E6%8F%92%E4%BB%B6%E7%9B%91%E5%90%AC%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>无星的前端之旅（三十）——怎么写word</title>
      <link>http://blog.xingxiaowu.cn/2024/09/12/%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85/%E6%97%A0%E6%98%9F%E7%9A%84%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%89%E5%8D%81%EF%BC%89%E2%80%94%E2%80%94%E6%80%8E%E4%B9%88%E5%86%99word/</link>
      <guid>http://blog.xingxiaowu.cn/2024/09/12/%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85/%E6%97%A0%E6%98%9F%E7%9A%84%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%89%E5%8D%81%EF%BC%89%E2%80%94%E2%80%94%E6%80%8E%E4%B9%88%E5%86%99word/</guid>
      <pubDate>Thu, 12 Sep 2024 10:23:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;有个业务要求，需要先进行一定的自动化操作&lt;/p&gt;
&lt;p&gt;将提取的信息写到Word里&lt;/p&gt;
&lt;h1 id=&quot;docxtemplater&quot;&gt;&lt;</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>有个业务要求，需要先进行一定的自动化操作</p><p>将提取的信息写到Word里</p><h1 id="docxtemplater"><a href="#docxtemplater" class="headerlink" title="docxtemplater"></a>docxtemplater</h1><p><a href="https://docxtemplater.com/">docxtemplater-官网</a></p><p><a href="https://github.com/open-xml-templating/docxtemplater">docxtemplater-GitHub</a></p><h1 id="集成"><a href="#集成" class="headerlink" title="集成"></a>集成</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm add docxtemplater pizzip fs-extra</span><br></pre></td></tr></table></figure><p>如果需要插入图片</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm add docxtemplater pizzip fs-extra docxtemplater-image-module-free image-size</span><br></pre></td></tr></table></figure><h1 id="渲染"><a href="#渲染" class="headerlink" title="渲染"></a>渲染</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// docUtils.js</span></span><br><span class="line"><span class="comment">// PizZip is required because docx/pptx/xlsx files are all zipped files, and</span></span><br><span class="line"><span class="comment">// the PizZip library allows us to load the file in memory</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">PizZip</span> = <span class="built_in">require</span>(<span class="string">&quot;pizzip&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Docxtemplater</span> = <span class="built_in">require</span>(<span class="string">&quot;docxtemplater&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs-extra&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ImageModule</span> = <span class="built_in">require</span>(<span class="string">&#x27;docxtemplater-image-module-free&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> sizeOf = <span class="built_in">require</span>(<span class="string">&quot;image-size&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 替换模板key</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * filePath: 文档路径</span></span><br><span class="line"><span class="comment"> * renderContent： 文档中的key要替换的内容，例如&#123; image: &quot;examples/image.png&quot; , aa: &quot;123&quot;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">replaceTemplateKey</span> = (<span class="params">filePath, renderContent</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// Load the docx file as binary content</span></span><br><span class="line">    <span class="keyword">const</span> content = fs.<span class="title function_">readFileSync</span>(filePath, <span class="string">&quot;binary&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> opts = &#123;</span><br><span class="line">        <span class="attr">centered</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">fileType</span>: <span class="string">&quot;docx&quot;</span>,<span class="comment">//Or pptx</span></span><br><span class="line">        <span class="title function_">getImage</span>(<span class="params">tagValue, tagName, meta</span>) &#123;</span><br><span class="line">            <span class="comment">//tagValue is &#x27;examples/image.png&#x27;</span></span><br><span class="line">            <span class="comment">//tagName is &#x27;image&#x27;</span></span><br><span class="line">            <span class="comment">// console.log(&#123; tagValue, tagName, meta &#125;);</span></span><br><span class="line">            <span class="keyword">return</span> fs.<span class="title function_">readFileSync</span>(tagValue);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">getSize</span>(<span class="params">img, tagValue, tagName</span>) &#123;</span><br><span class="line">            <span class="comment">//Pass the function that return image size</span></span><br><span class="line">            <span class="comment">//img is the image returned by opts.getImage()</span></span><br><span class="line">            <span class="comment">//tagValue is &#x27;examples/image.png&#x27;</span></span><br><span class="line">            <span class="comment">//tagName is &#x27;image&#x27;</span></span><br><span class="line">            <span class="comment">//tip: you can use node module &#x27;image-size&#x27; here</span></span><br><span class="line">            <span class="keyword">const</span> sizeObj = <span class="title function_">sizeOf</span>(img);</span><br><span class="line">            <span class="comment">// console.log(sizeObj);</span></span><br><span class="line">            <span class="keyword">const</span> multiple = sizeObj.<span class="property">width</span> / <span class="number">500</span></span><br><span class="line">            <span class="keyword">const</span> width = sizeObj.<span class="property">width</span> / multiple</span><br><span class="line">            <span class="keyword">const</span> height = sizeObj.<span class="property">height</span> / multiple</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> [width, height];</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> zip = <span class="keyword">new</span> <span class="title class_">PizZip</span>(content);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> doc = <span class="keyword">new</span> <span class="title class_">Docxtemplater</span>(zip, &#123;</span><br><span class="line">        <span class="attr">modules</span>: [<span class="keyword">new</span> <span class="title class_">ImageModule</span>(opts)],</span><br><span class="line">        <span class="attr">paragraphLoop</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">linebreaks</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 没给的值直接给空</span></span><br><span class="line">    <span class="comment">// doc.setOptions(&#123;</span></span><br><span class="line">    <span class="comment">//     nullGetter: function () &#123;</span></span><br><span class="line">    <span class="comment">//         return &quot;&quot;;</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">// &#125;); </span></span><br><span class="line">    </span><br><span class="line">    doc.<span class="title function_">render</span>(renderContent);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> buffer = doc.<span class="title function_">getZip</span>().<span class="title function_">generate</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;nodebuffer&quot;</span>,</span><br><span class="line">        <span class="comment">// compression: DEFLATE adds a compression step.</span></span><br><span class="line">        <span class="comment">// For a 50MB output document, expect 500ms additional CPU time</span></span><br><span class="line">        <span class="attr">compression</span>: <span class="string">&quot;DEFLATE&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    fs.<span class="title function_">writeFileSync</span>(filePath, buffer);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    replaceTemplateKey,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="doc模板"><a href="#doc模板" class="headerlink" title="doc模板"></a>doc模板</h1><h2 id="普通的文字"><a href="#普通的文字" class="headerlink" title="普通的文字"></a>普通的文字</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 模板.docx</span><br><span class="line"></span><br><span class="line">你好，我是&#123;name&#125;</span><br></pre></td></tr></table></figure><p>renderContent 为</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">name</span>:<span class="string">&quot;张三&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">你好，我是张三</span><br></pre></td></tr></table></figure><h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 模板.docx</span><br><span class="line"></span><br><span class="line">&#123;%template_pic_basic_info&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>renderContent 为</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">template_pic_basic_info</span>:<span class="string">&quot;file://a/v/b/c.png&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输入一张图片，这里不截图了</p><h2 id="布尔，是否渲染"><a href="#布尔，是否渲染" class="headerlink" title="布尔，是否渲染"></a>布尔，是否渲染</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 模板.docx</span><br><span class="line">&#123;#show1&#125;</span><br><span class="line">你好，我是&#123;name1&#125;</span><br><span class="line">&#123;/show1&#125;</span><br><span class="line">你好，我是&#123;name2&#125;</span><br></pre></td></tr></table></figure><p>renderContent 为</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">show1</span>:<span class="literal">true</span>,</span><br><span class="line">  <span class="attr">name1</span>:<span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  <span class="attr">name2</span>:<span class="string">&quot;李四&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">你好，我是张三</span><br><span class="line">你好，我是李四</span><br></pre></td></tr></table></figure><hr><p>renderContent 为</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">show1</span>:<span class="literal">false</span>,</span><br><span class="line">  <span class="attr">name1</span>:<span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  <span class="attr">name2</span>:<span class="string">&quot;李四&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">你好，我是李四</span><br></pre></td></tr></table></figure><h1 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h1><p>有多张图片要展示，不知道具体多少张</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 模板.docx</span><br><span class="line">&#123;#template_pic_account_history_info3&#125;</span><br><span class="line">&#123;%image&#125;</span><br><span class="line">&#123;/template_pic_account_history_info3&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>renderContent 为</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">template_pic_account_history_info3</span>:[</span><br><span class="line">    &#123;<span class="attr">image</span>:<span class="string">&quot;xxx/xxx.png&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">image</span>:<span class="string">&quot;xxx/xxx.png&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">image</span>:<span class="string">&quot;xxx/xxx.png&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">image</span>:<span class="string">&quot;xxx/xxx.png&quot;</span>&#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>渲染多张图片</p><h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>基本上就能满足大部分的需求了</p>]]></content:encoded>
      
      
      <category domain="http://blog.xingxiaowu.cn/categories/%E5%89%8D%E7%AB%AF/">前端</category>
      
      
      <category domain="http://blog.xingxiaowu.cn/tags/%E5%89%8D%E7%AB%AF/">前端</category>
      
      <category domain="http://blog.xingxiaowu.cn/tags/docx/">docx</category>
      
      <category domain="http://blog.xingxiaowu.cn/tags/doc/">doc</category>
      
      <category domain="http://blog.xingxiaowu.cn/tags/word/">word</category>
      
      
      <comments>http://blog.xingxiaowu.cn/2024/09/12/%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85/%E6%97%A0%E6%98%9F%E7%9A%84%E5%89%8D%E7%AB%AF%E4%B9%8B%E6%97%85%EF%BC%88%E4%B8%89%E5%8D%81%EF%BC%89%E2%80%94%E2%80%94%E6%80%8E%E4%B9%88%E5%86%99word/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
